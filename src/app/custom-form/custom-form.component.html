<div class="row visible-main-section">
  <div class="col-12">
    <div class="criteriaMap">
      <p style="position: relative">
        Criteria Map <span class="required">*</span>
      </p>
      <input
        type="text"
        pInputText
        [(ngModel)]="criteriaMapCode"
        maxlength="500"
        placeholder="Max 500 characters"
      />

      <button
        pButton
        pRipple
        type="button"
        label="Apply"
        class="p-button-raised"
        (click)="Apply()"
        [disabled]="criteriaMapCode.trim().length == 0"
      ></button>
    </div>
  </div>
  <div *ngIf="showForm" class="col-12">
    <form
      *ngIf="objectKeys(apiData).length"
      class="custom-form"
      [formGroup]="form"
      (ngSubmit)="onSubmit()"
    >
      <ng-container *ngFor="let section of formSections">
        <p-panel
          [header]="section.formName"
          [toggleable]="true"
          [formGroup]="form.controls[section.formName]"
          *ngIf="section.isVisible"
        >
          <div class="row">
            <ng-container *ngFor="let field of section.fields">
              <div *ngIf="field.visible" class="col-2">
                <label>{{ field.fieldLabel }}</label
                ><span *ngIf="field.required" class="required">*</span>
                <ng-container [ngSwitch]="field.inputType">
                  <input
                    *ngSwitchCase="'text'"
                    type="text"
                    class="block"
                    pInputText
                    [formControlName]="field.name"
                  />
                  <input
                  *ngSwitchCase="'number'"
                    type="text"
                    class="block"
                    pInputText
                    [formControlName]="field.name"
                  />
                  <p-calendar
                    *ngSwitchCase="'date'"
                    class="block"
                    [formControlName]="field.name"
                  ></p-calendar>
                  <input
                    *ngSwitchCase="'checkbox'"
                    class="block"
                    type="checkbox"
                    [formControlName]="field.name"
                  />
                  <select
                    *ngSwitchCase="'select'"
                    [formControlName]="field.name"
                  >
                    <option
                      *ngFor="let option of field.options"
                      [value]="option.value"
                    >
                      {{ option.label }}
                    </option>
                  </select>
                  <select
                    *ngSwitchCase="'multiselect'"
                    multiple
                    [formControlName]="field.name"
                  >
                    <option
                      *ngFor="let option of field.options"
                      [value]="option.value"
                    >
                      {{ option.label }}
                    </option>
                  </select>
                </ng-container>
                <small
                  *ngIf="
                    submitted &&
                    form.controls[section.formName]['controls'][field.name]
                      .errors?.required
                  "
                  class="p-error block"
                  >{{ field.fieldLabel }} is required.</small
                >
                <small
                  *ngIf="
                    submitted &&
                    form.controls[section.formName]['controls'][field.name]
                      .errors?.minlength
                  "
                  class="p-error block"
                  >{{ field.fieldLabel }} must be
                  {{ field.minLength }} characters long.</small
                >
                <small
                  *ngIf="
                    submitted &&
                    form.controls[section.formName]['controls'][field.name]
                      .errors?.pattern
                  "
                  class="p-error block"
                  >Improper {{ field.fieldLabel }} format.</small
                >
                <small
                  *ngIf="
                    submitted &&
                    form.controls[section.formName]['controls'][field.name]
                      .errors?.maxlength
                  "
                  class="p-error block"
                  >{{ field.fieldLabel }} must not exceed
                  {{ field.maxLength }} characters.</small
                >
              </div>
            </ng-container>
          </div>
        </p-panel>
        <p-panel
          *ngIf="!section.isVisible"
          [header]="section.formName"
          class="no-visible"
        >
          No Visible fields available.
        </p-panel>
      </ng-container>
      <div class="form-group">
        <button type="submit" class="btn btn-primary mr-2">Save</button>
        <button
          type="button"
          (click)="onReset()"
          class="btn btn-warning float-right"
        >
          Reset
        </button>
      </div>
    </form>
    <div *ngIf="!objectKeys(apiData).length" class="criteriaMap">
      {{ noDataMsg }}
    </div>
  </div>
</div>
