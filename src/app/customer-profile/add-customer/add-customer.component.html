<div class="row visible-main-section">
  <div class="btnRight">
    <button
      pButton
      pRipple
      type="button"
      (click)="saveCustomer()"
      label="Save"
      class="ml-2"
    ></button>
    <button
      pButton
      pRipple
      type="button"
      (click)="resetCustomerInfo()"
      label="Reset"
      class="p-button-warning ml-2"
    ></button>
  </div>
  <div *ngIf="showForm" class="col-12">
    <p-tabView>
      <p-tabPanel header="Individual">
        <form
          *ngIf="apiData.length"
          class="custom-form"
          [formGroup]="individualForm"
          (ngSubmit)="onSubmit()"
        >
          <ng-container *ngFor="let section of formSections">
            <p-panel
              [header]="section.formName"
              [toggleable]="true"
              [formGroup]="individualForm.controls[section.formName]"
              *ngIf="section.isVisible"
            >
              <div class="row">
                <ng-container *ngFor="let field of section.fields">
                  <div
                    [ngClass]="{
                      'col-2': field.fieldSubtype != 'checkbox',
                      checkbox: field.fieldSubtype == 'checkbox'
                    }"
                  >
                    <label>{{ field.fieldLabel }}</label
                    ><span *ngIf="field.required" class="required">*</span>
                    <ng-container [ngSwitch]="field.fieldType">
                      <ng-container
                        *ngSwitchCase="'input'"
                        [ngSwitch]="field.fieldSubtype"
                      >
                        <input
                          *ngSwitchCase="'text'"
                          type="text"
                          class="block"
                          pInputText
                          [formControlName]="field.name"
                          maxlength="40"
                          minlength="2"
                        />
                        <input
                          *ngSwitchCase="'number'"
                          type="text"
                          class="block"
                          pInputText
                          [formControlName]="field.name"
                        />
                        <p-calendar
                          *ngSwitchCase="'date'"
                          class="block"
                          placeholder="MM/DD/YYYY"
                          [showIcon]="true"
                          [formControlName]="field.name"
                          [minDate]="field.minDate"
                          [maxDate]="field.maxDate"
                          [defaultDate]="field.defaultDate"
                          [readonlyInput]="true"
                        ></p-calendar>
                        <p-checkbox
                          *ngSwitchCase="'checkbox'"
                          [formControlName]="field.name"
                          [binary]="true"
                          inputId="binary"
                        ></p-checkbox>
                      </ng-container>

                      <ng-container
                        *ngSwitchCase="'select'"
                        [ngSwitch]="field.fieldSubtype"
                      >
                        <p-dropdown
                          *ngSwitchCase="null"
                          class="block"
                          [options]="cities"
                          [formControlName]="field.name"
                          placeholder=""
                          optionLabel="name"
                          [showClear]="true"
                        ></p-dropdown>
                        <p-dropdown
                          *ngSwitchCase="'search'"
                          class="block"
                          [formControlName]="field.name"
                          [options]="countries"
                          optionLabel="name"
                          [filter]="true"
                          filterBy="name"
                          [showClear]="true"
                          placeholder="Type to search"
                        >
                          <ng-template pTemplate="selectedItem">
                            <div
                              class="country-item country-item-value"
                              *ngIf="selectedCountry"
                            >
                              <div>{{ selectedCountry.name }}</div>
                            </div>
                          </ng-template>
                          <ng-template let-country pTemplate="item">
                            <div class="country-item">
                              <div>{{ country.name }}</div>
                            </div>
                          </ng-template>
                        </p-dropdown>
                      </ng-container>

                      <select
                        *ngSwitchCase="'multiselect'"
                        multiple
                        [formControlName]="field.name"
                      >
                        <option
                          *ngFor="let option of field.options"
                          [value]="option.value"
                        >
                          {{ option.label }}
                        </option>
                      </select>
                    </ng-container>
                    <small
                      *ngIf="
                        submitted &&
                        individualForm.controls[section.formName]['controls'][
                          field.name
                        ].errors?.required
                      "
                      class="p-error block"
                      >{{ field.fieldLabel }} is required.</small
                    >
                    <small
                      *ngIf="
                        submitted &&
                        individualForm.controls[section.formName]['controls'][
                          field.name
                        ].errors?.minlength
                      "
                      class="p-error block"
                      >{{ field.fieldLabel }} must be 2 characters long.</small
                    >
                    <small
                      *ngIf="
                        submitted &&
                        individualForm.controls[section.formName]['controls'][
                          field.name
                        ].errors?.pattern
                      "
                      class="p-error block"
                      >Improper {{ field.fieldLabel }} format.</small
                    >
                    <small
                      *ngIf="
                        submitted &&
                        individualForm.controls[section.formName]['controls'][
                          field.name
                        ].errors?.maxlength
                      "
                      class="p-error block"
                      >{{ field.fieldLabel }} must not exceed 40
                      characters.</small
                    >
                  </div>
                </ng-container>
              </div>
            </p-panel>
            <p-panel
              *ngIf="!section.isVisible"
              [header]="section.formName"
              class="no-visible"
            >
              No Visible fields available.
            </p-panel>
          </ng-container>
          <div class="form-group">
            <button type="submit" class="btn btn-primary mr-2">Save</button>
            <button
              type="button"
              (click)="onReset()"
              class="btn btn-warning float-right"
            >
              Reset
            </button>
          </div>
        </form>
      </p-tabPanel>
      <p-tabPanel header="Corporate">
        <app-corporate></app-corporate>
      </p-tabPanel>
    </p-tabView>
  </div>
</div>
