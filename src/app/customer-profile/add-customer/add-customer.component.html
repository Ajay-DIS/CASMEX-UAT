<div class="row visible-main-section">
  <div *ngIf="showForm" class="col-12">
    <p-tabView
      (onChange)="handleChange($event)"
      [(activeIndex)]="activeTabIndex"
    >
      <p-tabPanel
        header="Individual"
        [disabled]="mode == 'edit' && custType == 'COR'"
      >
        <form
          *ngIf="objectKeys(apiData).length"
          class="custom-form"
          [formGroup]="individualForm"
        >
          <ng-container *ngFor="let section of formSections">
            <p-panel
              [header]="section.formName"
              [toggleable]="true"
              [formGroup]="individualForm.controls[section.formName]"
              *ngIf="section.isVisible"
            >
              <div class="row">
                <ng-container *ngFor="let field of section.fields">
                  <div
                  *ngIf="field.visible && field.fieldType != 'currency'"
                  [ngClass]="{
                    'col-2': true,
                    checkbox: field.fieldType == 'checkbox'
                  }"
                  >
                    <label>{{ field.fieldLabel }}</label
                    ><span *ngIf="field.required" class="required">*</span>
                    <ng-container [ngSwitch]="field.fieldType">
                     
                        <input
                          *ngSwitchCase="'text'"
                          type="text"
                          class="block"
                          pInputText
                          [formControlName]="field.name"
                        />
                        <input
                          *ngSwitchCase="'number'"
                          type="text"
                          class="block"
                          pInputText
                          [formControlName]="field.name"
                        />

                        <p-calendar
                          *ngSwitchCase="'date'"
                          class="block"
                          placeholder="MM/DD/YYYY"
                          [showIcon]="true"
                          [formControlName]="field.name"
                          [minDate]="field.minDate"
                          [maxDate]="field.maxDate"
                          [defaultDate]="field.defaultDate"
                          [readonlyInput]="true"
                          [appendTo]="'body'"
                        ></p-calendar>
                        <p-checkbox
                          *ngSwitchCase="'checkbox'"
                          [formControlName]="field.name"
                          [binary]="true"
                          inputId="binary"
                          (onChange)="sameAddress($event, field.name)"
                        ></p-checkbox>
                        <p-dropdown
                        *ngSwitchCase="'select'"
                        class="block"
                        [options]="masterData[field.apiKey]"
                        [formControlName]="field.name"
                        placeholder="&nbsp;"
                        optionLabel="codeName"
                      ></p-dropdown>
                      <p-dropdown
                      *ngSwitchCase="'smart-search'"
                      class="block"
                      [formControlName]="field.name"
                      [options]="masterData[field.apiKey]"
                      optionLabel="codeName"
                      [filter]="true"
                      filterBy="codeName"
                      placeholder="Type to search"
                    >
                      <ng-template pTemplate="selectedItem">
                        <div class="country-item country-item-value" *ngIf="field">
                          <div>
                            {{
                              individualForm.controls[section.formName]["controls"][
                                field.name
                              ].value.codeName
                            }}
                          </div>
                        </div>
                      </ng-template>
                      <ng-template let-country pTemplate="item">
                        <div class="country-item">
                          <div>{{ country.codeName }}</div>
                        </div>
                      </ng-template>
                    </p-dropdown>
                    <div *ngSwitchCase="'file'" class="file-upload">
                      <div class="file-upload-select" (click)="inpFile.click()">
                        <div class="file-select-name">
                          {{ inpFile.files.length ? inpFile.files[0].name : "" }}
                        </div>
                        <div class="file-select-button">
                          <i class="pi pi-upload"></i>
                        </div>
                        <input
                          #inpFile
                          type="file"
                          name="file-upload-input"
                          id="file-upload-input"
                        />
                      </div>
                    </div>
                      <select
                        *ngSwitchCase="'multiselect'"
                        multiple
                        [formControlName]="field.name"
                      >
                        <option
                          *ngFor="let option of field.options"
                          [value]="option.value"
                        >
                          {{ option.label }}
                        </option>
                      </select>
                    </ng-container>
                    <small
                      *ngIf="
                        submitted &&
                        individualForm.controls[section.formName]['controls'][
                          field.name
                        ].errors?.required
                      "
                      class="p-error block"
                      >{{ field.fieldLabel }} is required.</small
                    >
                    <small
                      *ngIf="
                        submitted &&
                        individualForm.controls[section.formName]['controls'][
                          field.name
                        ].errors?.minlength
                      "
                      class="p-error block"
                      >{{ field.fieldLabel }} must be {{ field.minLength }} characters long.</small
                    >
                    <small
                      *ngIf="
                        submitted &&
                        individualForm.controls[section.formName]['controls'][
                          field.name
                        ].errors?.pattern
                      "
                      class="p-error block"
                      >Improper {{ field.fieldLabel }} format.</small
                    >
                    <small
                      *ngIf="
                        submitted &&
                        individualForm.controls[section.formName]['controls'][
                          field.name
                        ].errors?.maxlength
                      "
                      class="p-error block"
                      >{{ field.fieldLabel }} must not exceed {{ field.maxLength }}
                      characters.</small
                    >
                  </div>
                </ng-container>
                <div *ngIf="section.formName == 'KYC Doc Upload'">
                  <button
                    #addCriteriaBtn
                    pButton
                    pRipple
                    style="position: static; left: 645px; font-size: 1.5rem"
                    type="button"
                    label="+"
                    class="p-button-primary"
                    (click)="addKyc()"
                  ></button>
                  <!-- <p-table
                    [value]="section.uploadedKyc"
                    *ngIf="section.uploadedKyc.length"
                  >
                    <ng-template pTemplate="header">
                      <tr>
                        <th>Document Type</th>
                        <th>ID Number</th>
                        <th>ID Issue Date</th>
                        <th>ID Expiry Date</th>
                        <th>ID Issue Authority</th>
                        <th>ID Issue Country</th>
                        <th>Front Side</th>
                        <th>Back Side</th>
                        <th>Doc History</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-product>
                      <tr>
                        <td
                          style="
                            cursor: pointer;
                            color: blue;
                            text-decoration: underline;
                          "
                          (click)="selectRowForEdit(product)"
                        >
                          {{ product.docType }}
                        </td>
                        <td>{{ product.idNumber }}</td>
                        <td>{{ product.idIssueDate }}</td>
                        <td>{{ product.idExpiryDate }}</td>
                        <td>{{ product.idIssueAuthority }}</td>
                        <td>{{ product.idIssueCountry }}</td>
                        <td>{{ product.uploadFrontSide }}</td>
                        <td>{{ product.uploadBackSide }}</td>
                        <td>
                          <button
                            pButton
                            type="button"
                            icon="pi pi-eye"
                            class="operation-btns"
                          ></button>
                          <button
                            pButton
                            type="button"
                            icon="pi pi-download"
                            class="operation-btns"
                          ></button>
                        </td>
                      </tr>
                    </ng-template>
                  </p-table> -->
                </div>
              </div>
            </p-panel>
            <p-panel
              *ngIf="!section.isVisible"
              [header]="section.formName"
              class="no-visible"
            >
              No Visible fields available.
            </p-panel>
          </ng-container>
          <div class="form-group btn-grp buttons-section">
            <button
              pButton
              pRipple
              type="button"
              label="Save"
              class="p-button-raised"
              (click)="onSubmit()"
            ></button>
            <button
              pButton
              pRipple
              type="button"
              label="Reset"
              class="p-button-warning"
              (click)="onReset()"
            ></button>
          </div>
        </form>
      </p-tabPanel>
      <p-tabPanel
        header="Corporate"
        [disabled]="mode == 'edit' && custType == 'IND'"
      >
        <ng-template pTemplate="content">
          <app-corporate [activeIndex]="activeTabIndex"></app-corporate>
        </ng-template>
      </p-tabPanel>
    </p-tabView>
  </div>
</div>
